<!DOCTYPE html>
<html lang="pt" xmlns:th="www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorator="index">
<head>
<title>Prime Eventos - Empresas</title>

</head>
<body>
	<section layout:fragment="conteudo">

		<div class="container" style="margin-top: 80px;">

			<!-- Link para abrir o form evento-->
			<div class="accordion" id="accordionExample">
			  	<div class="card">
			    	<div class="card-header" id="headingOne">
			      		<h2 class="mb-0">
			      			<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#evento" aria-expanded="false" aria-controls="collapseExample">
	    						Cadastro de Evento
	  						</button>
			      		</h2>
    				</div>
    			</div>
    		</div>

    		<!-- Form evento -->
			<div class="collapse" id="evento">
 				<div class="card card-body">
			   		<form class="form-group" method="POST" th:action="@{cadastrarEvento}"
			   		th:object="${eventoDTO}" enctype="multipart/form-data">
						<fieldset>
							<legend>Cadastro de Evento</legend>
							
							<div class="row">
								<div class="col-lg-4">
									<div th:class="${#fields.hasErrors('nome')}? error">
										<label for="nome">Nome do evento</label>
										<input class="form-control" id="nome" type="text" th:field="*{nome}">
									</div>
								</div>

								<div class="col-lg-4">
									<label for="cadaDeShow">Casa de show</label>
									<input class="form-control" id="cadaDeShow" type="text" th:field="*{casaDeShow}">
								</div>

								<div class="col-lg-2">
									<label for="ingressos">Total de ingressos</label>		
									<input class="form-control" id="ingressos" type="number" min="1" th:field="*{ingressosDisponiveis}">
								</div>

								<div class="col-lg-2">
									<label for="limite">Ingressos por cliente</label>		
									<input class="form-control" id="limite" type="number" min="1" th:field="*{limiteCliente}">
								</div>
							</div>

							<div class="row">
								<div class="col-lg-8">
									<label for="descricao">Descrição</label>
									<textarea rows=4 class="form-control" id="descricao" th:field="*{descricao}"></textarea>
								</div>

								<div class="col-lg-4">
									<label for="descricaoPequena">Descrição pequena</label>
									<textarea rows=4 class="form-control" id="descricaoPequena" th:field="*{pequenaDescricao}"></textarea>
								</div>				
							</div>

							<div class="row">
								<div class="col-lg-2">
									<label for="preco">Preço do ingresso</label>
									<div class="input-group">
										<div class="input-group-prepend">
											<span class="input-group-text">R$</span>
										</div>
										<input class="form-control" id="preco" type="text" th:field="*{preco}" onkeypress="$(this).mask('#.##0,00', {reverse: true});">
									</div>
								</div>

								<div class="col-lg-3">
									<label for="data">Data do evento</label>		
									<input class="form-control" id="data" type="date" th:field="*{data}">
								</div>
							</div>
							
							<br>
							<div class="row">
								<div class="form-group col-sm-12">
									<div th:class="${#fields.hasErrors('imagemCard')}? error">
										<label for="imagem">Foto para o card</label>
									  	<input type="file" id="imagem" accept=".jpg,.jpeg,.png" name="imagem" style="border: none">
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 10px;">
								<div class="col-lg-4">
									<button type="submit" class="btn btn-primary">Cadastrar</button>
								</div>
							</div>
						</fieldset>
					</form>
				</div>
			</div>
			
			<!-- Link para abrir o form casa de show-->
			<div class="accordion" id="botaoCasaDeShow">
			  	<div class="card">
			    	<div class="card-header" id="headingOne">
			      		<h2 class="mb-0">
			      			<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#casaDeShow" aria-expanded="false" aria-controls="collapseExample">
	    						Cadastro de Casa de Show
	  						</button>
			      		</h2>
    				</div>
    			</div>
    		</div>

    		<!-- Form casa de show -->
			<div class="collapse" id="casaDeShow">
 				<div class="card card-body">
			   		<form class="form-group" method="POST" th:action="@{cadastrarCasaDeShow}"
			   		th:object="${casaShow}">
						<fieldset>
							<legend>Cadastro de Casa de show</legend>
							
							<div th:if="${alertaCasa != null}" th:class="${alertaCasa == 'erro'} ? 'alert alert-danger' : 'alert alert-success'"
								 role="alert">
							  <h4 th:text="${titulo}" class="alert-heading">Cadastro não permitido</h4>
							  <p th:text="${texto}">Há campos inválidos</p>
							</div>
							
							<div class="row">
								<div class="col-lg-6">
									<label for="nome">Nome da casa</label>
									<input class="form-control" id="nome" type="text" th:field="*{nome}">
								</div>
								
								<div class="col-lg-2">
									<label for="nome">Limite de pessoas</label>
									<input class="form-control" id="limite" type="number" min="0" th:field="*{limitePessoas}">
								</div>
								
								<div class="col-lg-3">
									<label for="nome">Telefone</label>
									<input class="form-control" id="telefone" minlength="14" maxlength="14" type="text" th:field="*{telefone}" onkeypress="$(this).mask('(00) 00000-0000')">
								</div>
							</div>
							
							<div class="row">
								<div class="col-lg-2">
							        <label for="cep">Cep:</label>
							        <input class="form-control" name="cep" type="text" id="cep" maxlength="10" onkeypress="$(this).mask('00.000-000')" th:field="*{cep}" />
						        </div>
						        
							 	<div class="col-lg-4">
							        <label for="cidade">Cidade:</label>
							        <input class="form-control" name="cidade" type="text" id="cidade" size="40" th:field="*{cidade}"/>
							    </div>
							    
							    <div class="col-lg-4">
							        <label for="bairro">Bairro:</label>
							        <input class="form-control" name="bairro" type="text" id="bairro" size="40" th:field="*{bairro}" />
							    </div> 
							    
							    <div class="col-lg-1">
							        <label for="uf">Estado:</label>
							        <input class="form-control" name="uf" type="text" id="uf" size="2" th:field="*{uf}"/>
								</div>
							    
							</div>
							
							<div class="row">
								
						        <div class="col-lg-4">
							        <label for="rua">Rua:</label>
							        <input class="form-control" name="rua" type="text" id="rua" size="60" th:field="*{rua}"/>
						       	</div>
						       	
						       	<div class="col-lg-2">
						       		<label for="numero">Número:</label>
						       		<input class="form-control" name="numero" id="numero" type="number" th:field="*{numero}"/>
						       	</div>
								
							 </div>
							 
							<div class="row" style="margin-top: 10px;">
								<div class="col-lg-4">
									<button type="submit" class="btn btn-primary">Cadastrar</button>
								</div>
							</div>
						</fieldset>
					</form>
				</div>
			</div>

		</div>
		
		
    
	</section>
	
	<th:block layout:fragment="javascript-extra">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
     	<script type="text/javascript" >
	        $(document).ready(function() {
	
	            function limpa_formulário_cep() {
	                // Limpa valores do formulário de cep.
	                $("#rua").val("");
	                $("#bairro").val("");
	                $("#cidade").val("");
	                $("#uf").val("");
	            }
	            
	            //Quando o campo cep perde o foco.
	            $("#cep").blur(function() {
	
	                //Nova variável "cep" somente com dígitos.
	                var cep = $(this).val().replace(/\D/g, '');
	
	                //Verifica se campo cep possui valor informado.
	                if (cep != "") {
	
	                    //Expressão regular para validar o CEP.
	                    var validacep = /^[0-9]{8}$/;
	
	                    //Valida o formato do CEP.
	                    if(validacep.test(cep)) {
	
	                        //Preenche os campos com "..." enquanto consulta webservice.
	                        $("#rua").val("...");
	                        $("#bairro").val("...");
	                        $("#cidade").val("...");
	                        $("#uf").val("...");
	
	                        //Consulta o webservice viacep.com.br/
	                        $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {
	
	                            if (!("erro" in dados)) {
	                                //Atualiza os campos com os valores da consulta.
	                                $("#rua").val(dados.logradouro);
	                                $("#bairro").val(dados.bairro);
	                                $("#cidade").val(dados.localidade);
	                                $("#uf").val(dados.uf);
	                            } //end if.
	                            else {
	                                //CEP pesquisado não foi encontrado.
	                                limpa_formulário_cep();
	                                alert("CEP não encontrado.");
	                            }
	                        });
	                    } //end if.
	                    else {
	                        //cep é inválido.
	                        limpa_formulário_cep();
	                        alert("Formato de CEP inválido.");
	                    }
	                } //end if.
	                else {
	                    //cep sem valor, limpa formulário.
	                    limpa_formulário_cep();
	                }
	            });
	        });
	    </script>
        
	</th:block>
</body>
</html>